"use strict";!function(u,e,t,o){var s=u.getElementById("msg"),r=e.getItem("clashEditor:config:proxygroup"),n=e.getItem("clashEditor:config:rule"),d=[];if(r&&""!==r){jsyaml.load(r)["Proxy Group"].map(function(e){d.push("".concat(e.name))});var l=[];d.forEach(function(e){l.push("<code>".concat(e,"</code>"))}),u.getElementById("rule-proxygroup-list").innerHTML=l.join("，")}else Modal("这看起来不太正常","Clash Editor 无法读取您的 Proxy Group 配置！<br>3 秒后将会回到 Proxy Group 编辑页面！"),setTimeout(function(){o.location.pathname="/proxygroup"},3500);var p=t(u.getElementById("rule-editor"),{lineNumbers:!0,mode:"yaml"});n&&""!==n?p.setValue(n):p.setValue("Rule:\n"),u.getElementById("ce-rule-btn-validate").addEventListener("click",function(){try{var e=jsyaml.load(p.getValue()).Rule,r=["DOMAIN-SUFFIX","DOMAIN-KEYWORD","DOMAIN","IP-CIDR","SRC-IP-CIDR","GEOIP","DST-PORT","SRC-PORT","MATCH","FINAL"],n=d.concat(["DIRECT","REJECT"]);try{var t=!0,o=!1,l=void 0;try{for(var a,i=function(){var e=a.value,t=e.split(",")[0],o=e.split(",")[2];if(!n.some(function(e){return e===o||"MATCH"===t||"FINAL"===t}))throw new Error("Rule 中使用了不存在的 Proxy Group");if(!r.some(function(e){return e===t}))throw new Error("Clash Editor 不可辨识的匹配");setLS("clashEditor:config:rule",p.getValue()),s.innerHTML='<span class="text-success">Rule 检查通过</span>',u.getElementById("ce-rule-btn-continue").classList.remove("disabled"),u.getElementById("ce-rule-btn-continue").removeAttribute("disabled"),u.getElementById("ce-rule-btn-continue").setAttribute("href","/finish")},c=e[Symbol.iterator]();!(t=(a=c.next()).done);t=!0)i()}catch(e){o=!0,l=e}finally{try{t||null==c.return||c.return()}finally{if(o)throw l}}}catch(e){Modal("您的 Rule 不符合要求！","<p>报错信息如下所示：</p>\n                    <p><code>".concat(e,"</code></p>"))}}catch(e){Modal("这看起来不太正常","<p>Clash Editor 似乎不能解析您提交的 YAML 内容</p>\n                <p>报错信息如下所示：</p>\n                <p><code>".concat(e,"</code></p>\n                <p>如果您认为这不是您的问题，请在 Clash Editor 的 GitHub 上提交一条 issue，并在 issue 中附上报错信息以供调试</p>"))}})}(document,localStorage,CodeMirror,window);